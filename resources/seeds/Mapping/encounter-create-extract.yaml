id: encounter-create-extract
type: FHIRPath
resourceType: Mapping
body:
  resourceType: Bundle
  "{% assign %}":
    - patientId: "{{ %QuestionnaireResponse.answers('patient-id') }}"
    - practitioner: "{{ %QuestionnaireResponse.answers('practitioner') }}"
    - startDateTime: "{{ %QuestionnaireResponse.answers('start-date') }}"
    - admittedFrom: "{{ %QuestionnaireResponse.answers('admitted-from') }}"
    - encounterType: "{{ %QuestionnaireResponse.answers('encounter-type') }}"
  type: transaction
  entry:
    - request:
        url: /Encounter
        method: POST
      resource:
        resourceType: Encounter
        meta:
          profile:
            - http://hl7.org.au/fhir/core/StructureDefinition/au-core-encounter
        period:
          start: "{{ %startDateTime }}"
        status: in-progress
        class: "{{ %encounterType }}"
        hospitalization:
          admitSource:
            coding:
              - "{{ %admittedFrom }}"
        subject:
          reference: "Patient/{{ %patientId }}"
        participant:
          - individual: "{{ %practitioner }}"