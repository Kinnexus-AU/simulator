resourceType: Questionnaire
title: Patient
extension:
  - url: >-
      http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-launchContext
    extension:
      - url: name
        valueCoding:
          code: Patient
      - url: type
        valueCode: Patient
  - url: https://emr-core.beda.software/StructureDefinition/questionnaire-mapper
    valueReference:
      reference: Mapping/patient
status: active
id: patient
url: patient
name: patient
meta:
  profile:
    - https://emr-core.beda.software/StructureDefinition/fhir-emr-questionnaire
item:
  - linkId: patient-id
    text: PatientId
    type: string
    hidden: true
    initialExpression:
      language: text/fhirpath
      expression: "%Patient.id"

  - linkId: first-name
    text: First name
    type: string
    required: true
    maxLength: 40
    entryFormat: Enter first name
    initialExpression:
      language: text/fhirpath
      expression: "%Patient.name.given[0]"

  - linkId: last-name
    text: Last name
    type: string
    required: true
    maxLength: 40
    entryFormat: Enter last name
    initialExpression:
      language: text/fhirpath
      expression: "%Patient.name.family.first()"

  - linkId: birthdate
    text: Birthdate
    type: date
    required: true
    entryFormat: Select birthdate
    initialExpression:
      language: text/fhirpath
      expression: "%Patient.birthDate"

  - linkId: gender
    text: Gender
    type: choice
    required: true
    extension:
      - url: http://hl7.org/fhir/StructureDefinition/entryFormat
        valueString: Select gender        
    initialExpression:
      language: text/fhirpath
      expression: |-
        %Questionnaire.repeat(item).where(linkId='gender').answerOption.valueCoding.where(
          code=%Patient.gender
        )
    answerOption:
      - valueCoding:
          code: "male"
          system: http://hl7.org/fhir/administrative-gender
          display: Male
      - valueCoding:
          code: "female"
          system: http://hl7.org/fhir/administrative-gender
          display: Female
      - valueCoding:
          code: "other"
          system: http://hl7.org/fhir/administrative-gender
          display: Other
      - valueCoding:
          code: "unknown"
          system: http://hl7.org/fhir/administrative-gender
          display: Unknown

  - linkId: gender-identity
    text: Gender identity
    type: choice
    extension:
      - url: http://hl7.org/fhir/StructureDefinition/entryFormat
        valueString: Select gender
    initialExpression:
      language: text/fhirpath
      expression: |-
        %Patient.extension(
          'http://hl7.org/fhir/StructureDefinition/individual-genderIdentity'
        ).extension('value').valueCodeableConcept.coding.first()
    answerOption:
      - valueCoding:
          code: "446151000124109"
          system: http://snomed.info/sct
          display: Identifies as male gender (finding)
      - valueCoding:
          code: "446141000124107"
          system: http://snomed.info/sct
          display: Identifies as female gender (finding)
      - valueCoding:
          code: "33791000087105"
          system: http://snomed.info/sct
          display: Identifies as gender nonbinary
      - valueCoding:
          code: "asked-declined"
          system: http://terminology.hl7.org/CodeSystem/data-absent-reason
          display: Asked But Declined
      - valueCoding:
          code: "UNK"
          system: http://terminology.hl7.org/CodeSystem/v3-NullFlavor
          display: Unknown

  - linkId: birth-place
    text: Place of birth
    type: string
    entryFormat: Specify place of birth
    initialExpression:
      language: text/fhirpath
      expression: |-
        %Patient.extension('http://hl7.org/fhir/StructureDefinition/patient-birthPlace').valueAddress.text

  - linkId: indigenous-status
    text: Indigenous status
    type: choice
    initialExpression:
      language: text/fhirpath
      expression: |-
        %Patient.extension('http://hl7.org.au/fhir/StructureDefinition/indigenous-status').valueCoding
    preferredTerminologyServer: https://tx.ontoserver.csiro.au/fhir
    answerValueSet: https://healthterminologies.gov.au/fhir/ValueSet/australian-indigenous-status-1

  - linkId: marital-status
    text: Marital status
    type: choice
    entryFormat: Select marital status
    initialExpression:
      language: text/fhirpath
      expression: "%Patient.maritalStatus.coding.first()"
    preferredTerminologyServer: https://tx.dev.hl7.org.au/fhir
    answerValueSet: http://hl7.org/fhir/ValueSet/marital-status  

  - linkId: medicare-number
    text: Medicare number
    type: string
    required: true
    initialExpression:
      language: text/fhirpath
      expression: |-
        %Patient.identifier.where(system='http://ns.electronichealth.net.au/id/medicare-number').value
    extension:
      - url: http://hl7.org/fhir/StructureDefinition/entryFormat
        valueString: 0000-0000-0