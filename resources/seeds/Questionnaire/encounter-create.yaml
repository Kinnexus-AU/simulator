id: encounter-create
resourceType: Questionnaire
meta:
  profile:
    - https://emr-core.beda.software/StructureDefinition/fhir-emr-questionnaire
name: encounter-create
title: Admission
status: active
subjectType:
  - Patient
launchContext:
  - name:
      code: Patient
    type:
      - Patient
mapping:
  - reference: Mapping/encounter-create-extract
item:
  - linkId: patient-id
    text: PatientId
    type: string
    hidden: true
    initialExpression:
      language: text/fhirpath
      expression: "%Patient.id"

  - linkId: practitioner
    text: Treating doctor
    type: reference
    referenceResource:
      - Practitioner
    entryFormat: Select treating doctor
    answerExpression:
      language: application/x-fhir-query
      expression: "Practitioner"
    choiceColumn:
      - forDisplay: true
        path: >-
          name.given.first() + ' ' + name.family 

  - linkId: encounter-type
    text: Encounter type
    type: choice
    required: true
    entryFormat: Select encounter type
    preferredTerminologyServer: https://tx.dev.hl7.org.au/fhir
    answerValueSet: http://terminology.hl7.org.au/ValueSet/v3-ActEncounterCode-extended

  - linkId: admitted-from
    text: Source of admission
    type: choice
    entryFormat: Select source of admission
    preferredTerminologyServer: https://tx.dev.hl7.org.au/fhir
    answerValueSet: http://hl7.org/fhir/ValueSet/encounter-admit-source

  - linkId: start-date
    text: Date
    type: dateTime
    initialExpression:
      language: text/fhirpath
      expression: "now()"

